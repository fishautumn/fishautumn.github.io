var qt=Object.defineProperty;var Vt=(s,t,n)=>t in s?qt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var lt=(s,t,n)=>(Vt(s,typeof t!="symbol"?t+"":t,n),n);import{s as ht,e as g,d as b,f as S,i as _,O as Mt,v as C,k as E,l as v,P as j,Q as Ft,n as nt,A as _t,R as zt,C as Et,S as Rt,t as F,b as z,h as G,j as R,T as K,U as J,m as ft,V as Lt,W as Y,x as wt,X as Gt,Y as Xt}from"../chunks/scheduler.Bnapz6z0.js";import{S as dt,i as pt,b as gt,d as bt,m as vt,t as tt,g as Ht,c as St,a as et,e as yt,f as Jt}from"../chunks/index.DElnCtB0.js";function at(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function Kt(s,t){const n={},l={},i={$$scope:1};let u=s.length;for(;u--;){const o=s[u],e=t[u];if(e){for(const r in o)r in e||(l[r]=1);for(const r in e)i[r]||(n[r]=e[r],i[r]=1);s[u]=e}else for(const r in o)i[r]=1}for(const o in l)o in n||(n[o]=void 0);return n}function Qt(s){return typeof s=="object"&&s!==null?s:{}}function Wt(s){let t,n,l,i,u,o;return{c(){t=g("button"),n=g("img"),this.h()},l(e){t=b(e,"BUTTON",{id:!0,class:!0});var r=S(t);n=b(r,"IMG",{src:!0,alt:!0,class:!0}),r.forEach(_),this.h()},h(){Mt(n.src,l=s[2])||C(n,"src",l),C(n,"alt",""),C(n,"class","svelte-4wjcsy"),C(t,"id",i=`c-${s[0]}-${s[1]}`),C(t,"class","svelte-4wjcsy")},m(e,r){E(e,t,r),v(t,n),u||(o=[j(t,"click",s[3]),j(t,"contextmenu",Ft(s[8]))],u=!0)},p(e,[r]){r&4&&!Mt(n.src,l=e[2])&&C(n,"src",l),r&3&&i!==(i=`c-${e[0]}-${e[1]}`)&&C(t,"id",i)},i:nt,o:nt,d(e){e&&_(t),u=!1,_t(o)}}}function Yt(s,t,n){let l,{value:i}=t,{x:u}=t,{y:o}=t,{status:e}=t,{is_init:r}=t,{freeze:f}=t;const p=zt(),a={init:"init",clear:i,mark:"flag",fail:"mine-red",wrong:"flag-red"};function T(y){f||(r?e=="init"?y.button==0?i==-1?(n(4,e="fail"),p("fail",{x:u,y:o})):(n(4,e="clear"),i==0&&p("confirm",{x:u,y:o})):y.button==2&&(p("flag",{x:u,y:o}),n(4,e="mark")):e=="clear"&&i>0?p("confirm",{x:u,y:o}):e=="mark"&&y.button==2&&(p("unflag",{x:u,y:o}),n(4,e="init")):(n(5,r=!0),p("init",{x:u,y:o})))}const m=()=>T({button:2});return s.$$set=y=>{"value"in y&&n(6,i=y.value),"x"in y&&n(0,u=y.x),"y"in y&&n(1,o=y.y),"status"in y&&n(4,e=y.status),"is_init"in y&&n(5,r=y.is_init),"freeze"in y&&n(7,f=y.freeze)},s.$$.update=()=>{s.$$.dirty&80&&n(2,l=(a[e]??i??"init")+".svg")},[u,o,l,T,e,r,i,f,m]}class Zt extends dt{constructor(t){super(),pt(this,t,Yt,Wt,ht,{value:6,x:0,y:1,status:4,is_init:5,freeze:7})}}function Ot(s,t,n){const l=s.slice();return l[17]=t[n],l}function Nt(s){let t,n,l=s[17]+"",i,u,o,e,r;return o=Rt(s[8][0]),{c(){t=g("label"),n=g("input"),i=F(l),u=g("br"),this.h()},l(f){t=b(f,"LABEL",{});var p=S(t);n=b(p,"INPUT",{type:!0,name:!0}),i=G(p,l),p.forEach(_),u=b(f,"BR",{}),this.h()},h(){C(n,"type","radio"),C(n,"name","level"),n.__value=s[17],J(n,n.__value),o.p(n)},m(f,p){E(f,t,p),v(t,n),n.checked=n.__value===s[3],v(t,i),E(f,u,p),e||(r=[j(n,"change",s[7]),j(n,"change",s[5])],e=!0)},p(f,p){p&8&&(n.checked=n.__value===f[3])},d(f){f&&(_(t),_(u)),o.r(),e=!1,_t(r)}}}function $t(s){let t,n="width: ",l,i,u,o,e="height: ",r,f,p,a,T="count: ",m,y,B;return{c(){t=g("label"),t.textContent=n,l=g("input"),i=g("br"),u=z(),o=g("label"),o.textContent=e,r=g("input"),f=g("br"),p=z(),a=g("label"),a.textContent=T,m=g("input"),this.h()},l(c){t=b(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),K(t)!=="svelte-1fdanlc"&&(t.textContent=n),l=b(c,"INPUT",{type:!0,name:!0,class:!0}),i=b(c,"BR",{}),u=R(c),o=b(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),K(o)!=="svelte-19r74aw"&&(o.textContent=e),r=b(c,"INPUT",{type:!0,name:!0,class:!0}),f=b(c,"BR",{}),p=R(c),a=b(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),K(a)!=="svelte-t2iefa"&&(a.textContent=T),m=b(c,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){C(t,"for","width"),C(t,"class","svelte-k3yb6l"),C(l,"type","number"),C(l,"name","width"),C(l,"class","svelte-k3yb6l"),C(o,"for","height"),C(o,"class","svelte-k3yb6l"),C(r,"type","number"),C(r,"name","height"),C(r,"class","svelte-k3yb6l"),C(a,"for","count"),C(a,"class","svelte-k3yb6l"),C(m,"type","number"),C(m,"name","count"),C(m,"class","svelte-k3yb6l")},m(c,w){E(c,t,w),E(c,l,w),J(l,s[0]),E(c,i,w),E(c,u,w),E(c,o,w),E(c,r,w),J(r,s[1]),E(c,f,w),E(c,p,w),E(c,a,w),E(c,m,w),J(m,s[2]),y||(B=[j(l,"input",s[13]),j(r,"input",s[14]),j(m,"input",s[15])],y=!0)},p(c,w){w&1&&Y(l.value)!==c[0]&&J(l,c[0]),w&2&&Y(r.value)!==c[1]&&J(r,c[1]),w&4&&Y(m.value)!==c[2]&&J(m,c[2])},d(c){c&&(_(t),_(l),_(i),_(u),_(o),_(r),_(f),_(p),_(a),_(m)),y=!1,_t(B)}}}function te(s){let t,n="width: ",l,i,u,o,e="height: ",r,f,p,a,T="count: ",m,y,B;return{c(){t=g("label"),t.textContent=n,l=g("input"),i=g("br"),u=z(),o=g("label"),o.textContent=e,r=g("input"),f=g("br"),p=z(),a=g("label"),a.textContent=T,m=g("input"),this.h()},l(c){t=b(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),K(t)!=="svelte-1fdanlc"&&(t.textContent=n),l=b(c,"INPUT",{type:!0,name:!0,class:!0}),i=b(c,"BR",{}),u=R(c),o=b(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),K(o)!=="svelte-19r74aw"&&(o.textContent=e),r=b(c,"INPUT",{type:!0,name:!0,class:!0}),f=b(c,"BR",{}),p=R(c),a=b(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),K(a)!=="svelte-t2iefa"&&(a.textContent=T),m=b(c,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){C(t,"for","width"),C(t,"class","svelte-k3yb6l"),C(l,"type","number"),C(l,"name","width"),l.disabled=!0,C(l,"class","svelte-k3yb6l"),C(o,"for","height"),C(o,"class","svelte-k3yb6l"),C(r,"type","number"),C(r,"name","height"),r.disabled=!0,C(r,"class","svelte-k3yb6l"),C(a,"for","count"),C(a,"class","svelte-k3yb6l"),C(m,"type","number"),C(m,"name","count"),m.disabled=!0,C(m,"class","svelte-k3yb6l")},m(c,w){E(c,t,w),E(c,l,w),J(l,s[0]),E(c,i,w),E(c,u,w),E(c,o,w),E(c,r,w),J(r,s[1]),E(c,f,w),E(c,p,w),E(c,a,w),E(c,m,w),J(m,s[2]),y||(B=[j(l,"input",s[10]),j(r,"input",s[11]),j(m,"input",s[12])],y=!0)},p(c,w){w&1&&Y(l.value)!==c[0]&&J(l,c[0]),w&2&&Y(r.value)!==c[1]&&J(r,c[1]),w&4&&Y(m.value)!==c[2]&&J(m,c[2])},d(c){c&&(_(t),_(l),_(i),_(u),_(o),_(r),_(f),_(p),_(a),_(m)),y=!1,_t(B)}}}function ee(s){let t,n,l,i,u,o,e,r,f,p,a,T,m,y,B,c,w,q,A,P,O,I,st,d,x,h,k,L,U,M="<code>OK</code>",D,Q,Z,ut=at(Object.keys(s[4])),V=[];for(let N=0;N<ut.length;N+=1)V[N]=Nt(Ot(s,ut,N));function Bt(N,X){return N[3]in N[4]?te:$t}let kt=Bt(s),$=kt(s);return D=Rt(s[8][0]),{c(){t=g("div"),n=g("label"),l=g("code"),i=F("Level "),u=g("button"),o=g("code"),e=F(s[3]),r=F(": "),f=F(s[0]),p=F("x"),a=F(s[1]),T=F(","),m=F(s[2]),y=z(),B=g("dialog"),c=g("div");for(let N=0;N<V.length;N+=1)V[N].c();w=z(),q=g("label"),A=g("input"),P=F("custom"),O=g("br"),I=F(" "),st=z(),d=g("div"),$.c(),x=z(),h=g("br"),k=F(" "),L=z(),U=g("button"),U.innerHTML=M,this.h()},l(N){t=b(N,"DIV",{});var X=S(t);n=b(X,"LABEL",{});var H=S(n);l=b(H,"CODE",{});var W=S(l);i=G(W,"Level "),u=b(W,"BUTTON",{});var xt=S(u);o=b(xt,"CODE",{});var It=S(o);e=G(It,s[3]),It.forEach(_),xt.forEach(_),r=G(W,": "),f=G(W,s[0]),p=G(W,"x"),a=G(W,s[1]),T=G(W,","),m=G(W,s[2]),W.forEach(_),H.forEach(_),y=R(X),B=b(X,"DIALOG",{id:!0});var ot=S(B);c=b(ot,"DIV",{});var rt=S(c);for(let Tt=0;Tt<V.length;Tt+=1)V[Tt].l(rt);w=R(rt),q=b(rt,"LABEL",{});var Ct=S(q);A=b(Ct,"INPUT",{type:!0,name:!0}),P=G(Ct,"custom"),Ct.forEach(_),O=b(rt,"BR",{}),I=G(rt," "),rt.forEach(_),st=R(ot),d=b(ot,"DIV",{});var mt=S(d);$.l(mt),x=R(mt),h=b(mt,"BR",{}),k=G(mt," "),mt.forEach(_),L=R(ot),U=b(ot,"BUTTON",{"data-svelte-h":!0}),K(U)!=="svelte-hzki6z"&&(U.innerHTML=M),ot.forEach(_),X.forEach(_),this.h()},h(){C(A,"type","radio"),C(A,"name","level"),A.__value="custom",J(A,A.__value),C(B,"id","opt_dlg"),D.p(A)},m(N,X){E(N,t,X),v(t,n),v(n,l),v(l,i),v(l,u),v(u,o),v(o,e),v(l,r),v(l,f),v(l,p),v(l,a),v(l,T),v(l,m),v(t,y),v(t,B),v(B,c);for(let H=0;H<V.length;H+=1)V[H]&&V[H].m(c,null);v(c,w),v(c,q),v(q,A),A.checked=A.__value===s[3],v(q,P),v(c,O),v(c,I),v(B,st),v(B,d),$.m(d,null),v(d,x),v(d,h),v(d,k),v(B,L),v(B,U),Q||(Z=[j(u,"click",ne),j(A,"change",s[9]),j(A,"change",s[5]),j(U,"click",s[6])],Q=!0)},p(N,[X]){if(X&8&&ft(e,N[3]),X&1&&ft(f,N[0]),X&2&&ft(a,N[1]),X&4&&ft(m,N[2]),X&56){ut=at(Object.keys(N[4]));let H;for(H=0;H<ut.length;H+=1){const W=Ot(N,ut,H);V[H]?V[H].p(W,X):(V[H]=Nt(W),V[H].c(),V[H].m(c,w))}for(;H<V.length;H+=1)V[H].d(1);V.length=ut.length}X&8&&(A.checked=A.__value===N[3]),kt===(kt=Bt(N))&&$?$.p(N,X):($.d(1),$=kt(N),$&&($.c(),$.m(d,x)))},i:nt,o:nt,d(N){N&&_(t),Lt(V,N),$.d(),D.r(),Q=!1,_t(Z)}}}function ne(){document.querySelector("dialog#opt_dlg").showModal()}function le(s,t,n){const l={easy:{width:8,height:8,count:10},medium:{width:16,height:16,count:40},expert:{width:30,height:16,count:99}};let i="expert",{width:u=30}=t,{height:o=16}=t,{count:e=99}=t;function r(){if(i in l){const P=l[i];n(0,u=P.width),n(1,o=P.height),n(2,e=P.count)}}const f=zt();function p(){document.querySelector("dialog#opt_dlg").close(),f("change")}const a=[[]];function T(){i=this.__value,n(3,i)}function m(){i=this.__value,n(3,i)}function y(){u=Y(this.value),n(0,u)}function B(){o=Y(this.value),n(1,o)}function c(){e=Y(this.value),n(2,e)}function w(){u=Y(this.value),n(0,u)}function q(){o=Y(this.value),n(1,o)}function A(){e=Y(this.value),n(2,e)}return s.$$set=P=>{"width"in P&&n(0,u=P.width),"height"in P&&n(1,o=P.height),"count"in P&&n(2,e=P.count)},[u,o,e,i,l,r,p,T,a,m,y,B,c,w,q,A]}class se extends dt{constructor(t){super(),pt(this,t,le,ee,ht,{width:0,height:1,count:2})}get width(){return this.$$.ctx[0]}set width(t){this.$$set({width:t}),Et()}get height(){return this.$$.ctx[1]}set height(t){this.$$set({height:t}),Et()}get count(){return this.$$.ctx[2]}set count(t){this.$$set({count:t}),Et()}}function ie(s){let t,n,l=(s[0]/1e3).toFixed(3)+"",i,u;return{c(){t=g("code"),n=F("Elapsed: "),i=F(l),u=F(" seconds")},l(o){t=b(o,"CODE",{});var e=S(t);n=G(e,"Elapsed: "),i=G(e,l),u=G(e," seconds"),e.forEach(_)},m(o,e){E(o,t,e),v(t,n),v(t,i),v(t,u)},p(o,[e]){e&1&&l!==(l=(o[0]/1e3).toFixed(3)+"")&&ft(i,l)},i:nt,o:nt,d(o){o&&_(t)}}}function ue(s,t,n){let l=0,i=0,u=0,o,e=0;function r(){l=0,u=0,i=0,n(0,e=0),o&&(clearInterval(o),o=null)}function f(){r(),l=Date.now(),o=setInterval(()=>n(0,e=a()),100)}function p(){u=Date.now(),n(0,e=a()),o&&(clearInterval(o),o=null)}function a(){return l==0?0:u!=0?u+i-l:Date.now()+i-l}return[e,r,f,p]}class oe extends dt{constructor(t){super(),pt(this,t,ue,ie,ht,{reset:1,start:2,stop:3})}get reset(){return this.$$.ctx[1]}get start(){return this.$$.ctx[2]}get stop(){return this.$$.ctx[3]}}function Ut(s,t,n){const l=s.slice();return l[25]=t[n],l}function Dt(s,t,n){const l=s.slice();return l[28]=t[n],l[29]=t,l[30]=n,l}function At(s){let t,n,l;const i=[s[28]];function u(e){s[16](e,s[28])}let o={};for(let e=0;e<i.length;e+=1)o=Gt(o,i[e]);return s[28].status!==void 0&&(o.status=s[28].status),t=new Zt({props:o}),wt.push(()=>Jt(t,"status",u)),t.$on("flag",s[5]),t.$on("unflag",s[6]),t.$on("confirm",s[7]),t.$on("init",s[8]),t.$on("fail",s[9]),{c(){gt(t.$$.fragment)},l(e){bt(t.$$.fragment,e)},m(e,r){vt(t,e,r),l=!0},p(e,r){s=e;const f=r&8?Kt(i,[Qt(s[28])]):{};!n&&r&8&&(n=!0,f.status=s[28].status,Xt(()=>n=!1)),t.$set(f)},i(e){l||(tt(t.$$.fragment,e),l=!0)},o(e){et(t.$$.fragment,e),l=!1},d(e){yt(t,e)}}}function Pt(s){let t,n,l,i=at(s[25]),u=[];for(let e=0;e<i.length;e+=1)u[e]=At(Dt(s,i,e));const o=e=>et(u[e],1,1,()=>{u[e]=null});return{c(){t=g("div");for(let e=0;e<u.length;e+=1)u[e].c();n=z(),this.h()},l(e){t=b(e,"DIV",{class:!0});var r=S(t);for(let f=0;f<u.length;f+=1)u[f].l(r);n=R(r),r.forEach(_),this.h()},h(){C(t,"class","row svelte-73hlw")},m(e,r){E(e,t,r);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(t,null);v(t,n),l=!0},p(e,r){if(r&1e3){i=at(e[25]);let f;for(f=0;f<i.length;f+=1){const p=Dt(e,i,f);u[f]?(u[f].p(p,r),tt(u[f],1)):(u[f]=At(p),u[f].c(),tt(u[f],1),u[f].m(t,n))}for(Ht(),f=i.length;f<u.length;f+=1)o(f);St()}},i(e){if(!l){for(let r=0;r<i.length;r+=1)tt(u[r]);l=!0}},o(e){u=u.filter(Boolean);for(let r=0;r<u.length;r+=1)et(u[r]);l=!1},d(e){e&&_(t),Lt(u,e)}}}function re(s){let t,n,l,i,u,o,e,r,f,p,a,T,m="restart",y,B,c,w,q,A={};t=new se({props:A}),s[14](t),t.$on("change",s[0]);let P={};f=new oe({props:P}),s[15](f);let O=at(s[3]),I=[];for(let d=0;d<O.length;d+=1)I[d]=Pt(Ut(s,O,d));const st=d=>et(I[d],1,1,()=>{I[d]=null});return{c(){gt(t.$$.fragment),n=z(),l=g("p"),i=g("code"),u=F("Remain: "),o=F(s[4]),e=z(),r=g("p"),gt(f.$$.fragment),p=z(),a=g("p"),T=g("button"),T.textContent=m,y=z(),B=g("div");for(let d=0;d<I.length;d+=1)I[d].c()},l(d){bt(t.$$.fragment,d),n=R(d),l=b(d,"P",{});var x=S(l);i=b(x,"CODE",{});var h=S(i);u=G(h,"Remain: "),o=G(h,s[4]),h.forEach(_),x.forEach(_),e=R(d),r=b(d,"P",{});var k=S(r);bt(f.$$.fragment,k),k.forEach(_),p=R(d),a=b(d,"P",{});var L=S(a);T=b(L,"BUTTON",{"data-svelte-h":!0}),K(T)!=="svelte-5dldn0"&&(T.textContent=m),L.forEach(_),y=R(d),B=b(d,"DIV",{});var U=S(B);for(let M=0;M<I.length;M+=1)I[M].l(U);U.forEach(_)},m(d,x){vt(t,d,x),E(d,n,x),E(d,l,x),v(l,i),v(i,u),v(i,o),E(d,e,x),E(d,r,x),vt(f,r,null),E(d,p,x),E(d,a,x),v(a,T),E(d,y,x),E(d,B,x);for(let h=0;h<I.length;h+=1)I[h]&&I[h].m(B,null);c=!0,w||(q=j(T,"click",s[0]),w=!0)},p(d,[x]){const h={};t.$set(h),(!c||x&16)&&ft(o,d[4]);const k={};if(f.$set(k),x&1e3){O=at(d[3]);let L;for(L=0;L<O.length;L+=1){const U=Ut(d,O,L);I[L]?(I[L].p(U,x),tt(I[L],1)):(I[L]=Pt(U),I[L].c(),tt(I[L],1),I[L].m(B,null))}for(Ht(),L=O.length;L<I.length;L+=1)st(L);St()}},i(d){if(!c){tt(t.$$.fragment,d),tt(f.$$.fragment,d);for(let x=0;x<O.length;x+=1)tt(I[x]);c=!0}},o(d){et(t.$$.fragment,d),et(f.$$.fragment,d),I=I.filter(Boolean);for(let x=0;x<I.length;x+=1)et(I[x]);c=!1},d(d){d&&(_(n),_(l),_(e),_(r),_(p),_(a),_(y),_(B)),s[14](null),yt(t,d),s[15](null),yt(f),Lt(I,d),w=!1,q()}}}function fe(s){switch(s.status){case"init":return" ";case"mark":return"F";case"clear":return s.value;default:return"X"}}function ce(s,t,n){let l={width:30,height:16,count:99},i={};const u=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]];function o(h,k){let L=0;for(let U of u){const M=h+U[0],D=k+U[1];0<=M&&M<l.width&&0<=D&&D<l.height&&e[D][M].value==-1&&++L}return L}let e,r,f;y();function p(h,k){n(4,--f)}function a(h,k){n(4,++f)}function T(h,k){let L=0;for(let U of u){const M=h+U[0],D=k+U[1];0<=M&&M<l.width&&0<=D&&D<l.height&&e[D][M].status=="mark"&&++L}return L}function m(h){const k=[[h.detail.x,h.detail.y]];for(;k.length>0;){const L=k.pop(),U=L[0],M=L[1];if(T(U,M)==e[M][U].value)for(let D of u){const Q=U+D[0],Z=M+D[1];0<=Q&&Q<l.width&&0<=Z&&Z<l.height&&e[Z][Q].status=="init"&&(e[Z][Q].value>=0?n(3,e[Z][Q].status="clear",e):(n(3,e[Z][Q].status="fail",e),c()),e[Z][Q].value==0&&k.push([Q,Z]))}}}function y(){r="working",n(3,e=[]);for(let h=0;h<l.height;++h){n(3,e[h]=[],e);for(let k=0;k<l.width;++k)n(3,e[h][k]={x:k,y:h,status:"init",value:null,is_init:!1,freeze:!1},e)}n(4,f=l.count),i.reset&&i.reset()}function B(h){const k=h.detail.x,L=h.detail.y;let U=0;for(;U<l.count;){const M=Math.floor(Math.random()*l.width),D=Math.floor(Math.random()*l.height);k-1<=M&&M<=k+1&&L-1<=D&&D<=L+1||e[D][M].value==null&&(n(3,e[D][M].value=-1,e),U++)}for(let M=0;M<l.height;++M)for(let D=0;D<l.width;++D)n(3,e[M][D].is_init=!0,e),e[M][D].value==null&&n(3,e[M][D].value=o(D,M),e);n(3,e[L][k].status="clear",e),m({detail:{x:k,y:L}}),i.start()}function c(){i.stop(),r="failure";for(let h=0;h<l.height;++h)for(let k=0;k<l.width;++k)n(3,e[h][k].freeze=!0,e),e[h][k].value!=-1&&e[h][k].status=="mark"&&n(3,e[h][k].status="wrong",e)}function w(){return r!="working"||f>0||q()||(i.stop(),r="success"),r}function q(){for(const h of e)for(const k of h)if(k.status=="init")return!0;return!1}function A(){return{status:w(),count:l.count,remain:f,width:l.width,height:l.height,data:e.map(h=>h.map(fe))}}function P(h,k){e[k][h].status=="init"&&(n(4,--f),n(3,e[k][h].status="mark",e))}function O(h,k){e[k][h].status=="init"&&(e[k][h].value>=0?n(3,e[k][h].status="clear",e):(n(3,e[k][h].status="fail",e),c())),document.querySelector(`button#c-${h}-${k}`).click()}function I(){navigator.clipboard.writeText(JSON.stringify(e))}function st(h){wt[h?"unshift":"push"](()=>{l=h,n(1,l)})}function d(h){wt[h?"unshift":"push"](()=>{i=h,n(2,i)})}function x(h,k){s.$$.not_equal(k.status,h)&&(k.status=h,n(3,e))}return[y,l,i,e,f,p,a,m,B,c,A,P,O,I,st,d,x]}class ae extends dt{constructor(t){super(),pt(this,t,ce,re,ht,{restart:0,view:10,mark:11,dig:12,do_copy:13})}get restart(){return this.$$.ctx[0]}get view(){return this.$$.ctx[10]}get mark(){return this.$$.ctx[11]}get dig(){return this.$$.ctx[12]}get do_copy(){return this.$$.ctx[13]}}function he(s,t){for(let n=0;n<s.height;++n){const l=s.data[n];for(let i=0;i<s.width;++i)t({x:i,y:n},l[i])}}function _e(s,t,n){const l=[{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}];for(const i of l){const u=t.x+i.x,o=t.y+i.y;0<=u&&u<s.width&&0<=o&&o<s.height&&n({x:u,y:o},s.data[o][u])}}function jt(s,t){let n=s.y-t.y;return n!=0?n:s.x-t.x}function it(s){return`${s.x},${s.y}`}class ct{constructor(t,n){lt(this,"cells");lt(this,"sum");this.cells=t.sort(jt),this.sum=n}is_definitive(){return this.sum==0||this.sum==this.cells.length}}class de{constructor(t,n){lt(this,"positive");lt(this,"negative");lt(this,"sum");if(t.sum<n.sum){const e=t;t=n,n=e}this.positive=[],this.negative=[],this.sum=t.sum-n.sum;const l=t.cells.length,i=n.cells.length;let u=0,o=0;for(;u<l&&o<i;){const e=jt(t.cells[u],n.cells[o]);e<0?(this.positive.push(t.cells[u]),++u):e>0?(this.negative.push(n.cells[o]),++o):(++u,++o)}for(;u<l;++u)this.positive.push(t.cells[u]);for(;o<i;++o)this.negative.push(n.cells[o])}is_definitive(){return this.sum==this.positive.length||this.sum+this.negative.length==0}make_set(){const t=[];return this.sum==this.positive.length?(this.positive.length>0&&t.push(new ct(this.positive,this.sum)),this.negative.length>0&&t.push(new ct(this.negative,0))):this.sum+this.negative.length==0&&(this.positive.length>0&&t.push(new ct(this.positive,0)),this.negative.length>0&&t.push(new ct(this.negative,-this.sum))),t}}function pe(s){if(s.remain<s.count)return!1;for(const t of s.data)for(const n of t)if(n!=" ")return!1;return!0}function me(s){const t=[];for(let n=0;n<s.height;++n){const l=s.data[n];for(let i=0;i<s.width;++i)l[i]===" "&&t.push({x:i,y:n})}return new ct(t,s.remain)}function ge(s,t){if(s.status!="working")return[];if(pe(s))return[{x:Math.floor(s.width/2),y:Math.floor(s.height/2),op:"dig"}];const n=[];n.push(me(s)),he(s,(u,o)=>{if(typeof o=="number"){const e=[];let r=o;_e(s,u,(f,p)=>{p===" "?e.push(f):p=="F"&&--r}),e.length>0&&n.push(new ct(e,r))}});let i=new be(n).analyze();return i.length==0&&t&&(i=[ve(n)]),i}class be{constructor(t){lt(this,"sets");lt(this,"map");this.sets=t,this.dig_set=[],this.mark_set=[],this.map={};for(const n of t)for(const l of n.cells){let i=this.map[it(l)];i==null&&(i=[],this.map[it(l)]=i),i.push(n)}}analyze(){let t=!0;for(;t;){t=!1;for(const l of this.sets)if(!(l.sum>8))for(const i of l.cells)for(const u of this.map[it(i)]){if(u===l||u.sum<l.sum)continue;const e=new de(u,l).make_set();if(e.length!=0){for(const r of u.cells)if(!e[0].cells.some(f=>f==r)){const f=this.map[it(r)];this.map[it(r)]=f.filter(p=>p!==u)}if(u.sum=e[0].sum,u.cells=e[0].cells,e.length==2){this.sets.push(e[1]);for(const r of e[1].cells){let f=this.map[it(r)];f==null&&(f=[],this.map[it(r)]=f),f.push(l)}}t=!0}}}const n=[];for(const l of this.sets)if(l.sum==0)for(const i of l.cells)n.push({x:i.x,y:i.y,op:"dig"});else if(l.sum==l.cells.length)for(const i of l.cells)n.push({x:i.x,y:i.y,op:"mark"});return n}}function ve(s){const t=[];for(const i of s){const u=i.sum/i.cells.length;for(const o of i.cells){let e;o.y in t?e=t[o.y]:(e=[],t[o.y]=e),o.x in e?u>e[o.x]&&(e[o.x]=u):e[o.x]=u}}let n=2,l;for(const[i,u]of t.entries())if(u!=null)for(const[o,e]of u.entries())e!=null&&e>0&&e<n&&(n=e,l={x:o,y:i});return{x:l.x,y:l.y,op:"dig"}}function ye(s){let t,n,l,i,u="<code>Go</code>",o,e,r="<code>Step</code>",f,p,a,T,m,y="<code>Go Guess</code>",B,c,w="<code>Step Guess</code>",q,A;return{c(){t=g("div"),n=g("p"),l=z(),i=g("button"),i.innerHTML=u,o=z(),e=g("button"),e.innerHTML=r,f=z(),p=g("br"),a=g("br"),T=z(),m=g("button"),m.innerHTML=y,B=z(),c=g("button"),c.innerHTML=w},l(P){t=b(P,"DIV",{});var O=S(t);n=b(O,"P",{}),S(n).forEach(_),l=R(O),i=b(O,"BUTTON",{"data-svelte-h":!0}),K(i)!=="svelte-191pd97"&&(i.innerHTML=u),o=R(O),e=b(O,"BUTTON",{"data-svelte-h":!0}),K(e)!=="svelte-1bunicv"&&(e.innerHTML=r),f=R(O),p=b(O,"BR",{}),a=b(O,"BR",{}),T=R(O),m=b(O,"BUTTON",{"data-svelte-h":!0}),K(m)!=="svelte-qgdn0r"&&(m.innerHTML=y),B=R(O),c=b(O,"BUTTON",{"data-svelte-h":!0}),K(c)!=="svelte-1c4pp3z"&&(c.innerHTML=w),O.forEach(_)},m(P,O){E(P,t,O),v(t,n),v(t,l),v(t,i),v(t,o),v(t,e),v(t,f),v(t,p),v(t,a),v(t,T),v(t,m),v(t,B),v(t,c),q||(A=[j(i,"click",s[3]),j(e,"click",s[4]),j(m,"click",s[5]),j(c,"click",s[6])],q=!0)},p:nt,i:nt,o:nt,d(P){P&&_(t),q=!1,_t(A)}}}function ke(s,t,n){let{field:l}=t;function i(a){const T=l.view();if(T.status!="working")return!1;const m=u(T,a);if(!m||m.length==0)return!1;for(const y of m)switch(y.op){case"dig":l.dig(y.x,y.y);break;case"mark":l.mark(y.x,y.y)}return!0}function u(a,T){return ge(a,T)}async function o(a){setTimeout(()=>{i(a)&&o(a)},20)}const e=()=>o(!1),r=()=>i(!1),f=()=>o(!0),p=()=>i(!0);return s.$$set=a=>{"field"in a&&n(2,l=a.field)},[i,o,l,e,r,f,p]}class we extends dt{constructor(t){super(),pt(this,t,ke,ye,ht,{field:2})}}function Ce(s){let t,n,l,i,u,o,e,r="github source code",f,p={};return t=new ae({props:p}),s[1](t),l=new we({props:{field:s[0]}}),{c(){gt(t.$$.fragment),n=z(),gt(l.$$.fragment),i=z(),u=g("br"),o=z(),e=g("a"),e.textContent=r,this.h()},l(a){bt(t.$$.fragment,a),n=R(a),bt(l.$$.fragment,a),i=R(a),u=b(a,"BR",{}),o=R(a),e=b(a,"A",{href:!0,"data-svelte-h":!0}),K(e)!=="svelte-1iae31h"&&(e.textContent=r),this.h()},h(){C(e,"href","https://github.com/fishautumn/mine")},m(a,T){vt(t,a,T),E(a,n,T),vt(l,a,T),E(a,i,T),E(a,u,T),E(a,o,T),E(a,e,T),f=!0},p(a,[T]){const m={};t.$set(m);const y={};T&1&&(y.field=a[0]),l.$set(y)},i(a){f||(tt(t.$$.fragment,a),tt(l.$$.fragment,a),f=!0)},o(a){et(t.$$.fragment,a),et(l.$$.fragment,a),f=!1},d(a){a&&(_(n),_(i),_(u),_(o),_(e)),s[1](null),yt(t,a),yt(l,a)}}}function Te(s,t,n){let l;function i(u){wt[u?"unshift":"push"](()=>{l=u,n(0,l)})}return[l,i]}class xe extends dt{constructor(t){super(),pt(this,t,Te,Ce,ht,{})}}export{xe as component};
