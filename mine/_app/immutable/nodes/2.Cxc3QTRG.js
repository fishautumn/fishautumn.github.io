import{s as ft,e as x,d as C,f as q,i as y,O as Lt,v as B,k as O,l as E,P as F,Q as St,n as lt,A as ct,R as jt,C as xt,S as zt,t as H,b as R,h as X,j as S,T as Z,U as Q,m as ut,V as Ct,W as Y,x as yt,X as qt,Y as Vt}from"../chunks/scheduler.Bnapz6z0.js";import{S as at,i as ht,b as _t,d as dt,m as gt,t as et,g as Mt,c as Rt,a as nt,e as pt,f as Ft}from"../chunks/index.DElnCtB0.js";function rt(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function Gt(i,t){const n={},l={},r={$$scope:1};let s=i.length;for(;s--;){const o=i[s],e=t[s];if(e){for(const u in o)u in e||(l[u]=1);for(const u in e)r[u]||(n[u]=e[u],r[u]=1);i[s]=e}else for(const u in o)r[u]=1}for(const o in l)o in n||(n[o]=void 0);return n}function Ht(i){return typeof i=="object"&&i!==null?i:{}}function Xt(i){let t,n,l,r,s,o;return{c(){t=x("button"),n=x("img"),this.h()},l(e){t=C(e,"BUTTON",{id:!0,class:!0});var u=q(t);n=C(u,"IMG",{src:!0,alt:!0,class:!0}),u.forEach(y),this.h()},h(){Lt(n.src,l=i[2])||B(n,"src",l),B(n,"alt",""),B(n,"class","svelte-4wjcsy"),B(t,"id",r=`c-${i[0]}-${i[1]}`),B(t,"class","svelte-4wjcsy")},m(e,u){O(e,t,u),E(t,n),s||(o=[F(t,"click",i[3]),F(t,"contextmenu",St(i[8]))],s=!0)},p(e,[u]){u&4&&!Lt(n.src,l=e[2])&&B(n,"src",l),u&3&&r!==(r=`c-${e[0]}-${e[1]}`)&&B(t,"id",r)},i:lt,o:lt,d(e){e&&y(t),s=!1,ct(o)}}}function Jt(i,t,n){let l,{value:r}=t,{x:s}=t,{y:o}=t,{status:e}=t,{is_init:u}=t,{freeze:c}=t;const p=jt(),m={init:"init",clear:r,mark:"flag",fail:"mine-red",wrong:"flag-red"};function U(d){c||(u?e=="init"?d.button==0?r==-1?(n(4,e="fail"),p("fail",{x:s,y:o})):(n(4,e="clear"),r==0&&p("confirm",{x:s,y:o})):d.button==2&&(p("flag",{x:s,y:o}),n(4,e="mark")):e=="clear"&&r>0?p("confirm",{x:s,y:o}):e=="mark"&&d.button==2&&(p("unflag",{x:s,y:o}),n(4,e="init")):(n(5,u=!0),p("init",{x:s,y:o})))}const a=()=>U({button:2});return i.$$set=d=>{"value"in d&&n(6,r=d.value),"x"in d&&n(0,s=d.x),"y"in d&&n(1,o=d.y),"status"in d&&n(4,e=d.status),"is_init"in d&&n(5,u=d.is_init),"freeze"in d&&n(7,c=d.freeze)},i.$$.update=()=>{i.$$.dirty&80&&n(2,l=(m[e]??r??"init")+".svg")},[s,o,l,U,e,u,r,c,a]}class Kt extends at{constructor(t){super(),ht(this,t,Jt,Xt,ft,{value:6,x:0,y:1,status:4,is_init:5,freeze:7})}}function It(i,t,n){const l=i.slice();return l[17]=t[n],l}function Ot(i){let t,n,l=i[17]+"",r,s,o,e,u;return o=zt(i[8][0]),{c(){t=x("label"),n=x("input"),r=H(l),s=x("br"),this.h()},l(c){t=C(c,"LABEL",{});var p=q(t);n=C(p,"INPUT",{type:!0,name:!0}),r=X(p,l),p.forEach(y),s=C(c,"BR",{}),this.h()},h(){B(n,"type","radio"),B(n,"name","level"),n.__value=i[17],Q(n,n.__value),o.p(n)},m(c,p){O(c,t,p),E(t,n),n.checked=n.__value===i[3],E(t,r),O(c,s,p),e||(u=[F(n,"change",i[7]),F(n,"change",i[5])],e=!0)},p(c,p){p&8&&(n.checked=n.__value===c[3])},d(c){c&&(y(t),y(s)),o.r(),e=!1,ct(u)}}}function Qt(i){let t,n="width: ",l,r,s,o,e="height: ",u,c,p,m,U="count: ",a,d,v;return{c(){t=x("label"),t.textContent=n,l=x("input"),r=x("br"),s=R(),o=x("label"),o.textContent=e,u=x("input"),c=x("br"),p=R(),m=x("label"),m.textContent=U,a=x("input"),this.h()},l(f){t=C(f,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1fdanlc"&&(t.textContent=n),l=C(f,"INPUT",{type:!0,name:!0,class:!0}),r=C(f,"BR",{}),s=S(f),o=C(f,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-19r74aw"&&(o.textContent=e),u=C(f,"INPUT",{type:!0,name:!0,class:!0}),c=C(f,"BR",{}),p=S(f),m=C(f,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(m)!=="svelte-t2iefa"&&(m.textContent=U),a=C(f,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){B(t,"for","width"),B(t,"class","svelte-k3yb6l"),B(l,"type","number"),B(l,"name","width"),B(l,"class","svelte-k3yb6l"),B(o,"for","height"),B(o,"class","svelte-k3yb6l"),B(u,"type","number"),B(u,"name","height"),B(u,"class","svelte-k3yb6l"),B(m,"for","count"),B(m,"class","svelte-k3yb6l"),B(a,"type","number"),B(a,"name","count"),B(a,"class","svelte-k3yb6l")},m(f,w){O(f,t,w),O(f,l,w),Q(l,i[0]),O(f,r,w),O(f,s,w),O(f,o,w),O(f,u,w),Q(u,i[1]),O(f,c,w),O(f,p,w),O(f,m,w),O(f,a,w),Q(a,i[2]),d||(v=[F(l,"input",i[13]),F(u,"input",i[14]),F(a,"input",i[15])],d=!0)},p(f,w){w&1&&Y(l.value)!==f[0]&&Q(l,f[0]),w&2&&Y(u.value)!==f[1]&&Q(u,f[1]),w&4&&Y(a.value)!==f[2]&&Q(a,f[2])},d(f){f&&(y(t),y(l),y(r),y(s),y(o),y(u),y(c),y(p),y(m),y(a)),d=!1,ct(v)}}}function Wt(i){let t,n="width: ",l,r,s,o,e="height: ",u,c,p,m,U="count: ",a,d,v;return{c(){t=x("label"),t.textContent=n,l=x("input"),r=x("br"),s=R(),o=x("label"),o.textContent=e,u=x("input"),c=x("br"),p=R(),m=x("label"),m.textContent=U,a=x("input"),this.h()},l(f){t=C(f,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1fdanlc"&&(t.textContent=n),l=C(f,"INPUT",{type:!0,name:!0,class:!0}),r=C(f,"BR",{}),s=S(f),o=C(f,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-19r74aw"&&(o.textContent=e),u=C(f,"INPUT",{type:!0,name:!0,class:!0}),c=C(f,"BR",{}),p=S(f),m=C(f,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(m)!=="svelte-t2iefa"&&(m.textContent=U),a=C(f,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){B(t,"for","width"),B(t,"class","svelte-k3yb6l"),B(l,"type","number"),B(l,"name","width"),l.disabled=!0,B(l,"class","svelte-k3yb6l"),B(o,"for","height"),B(o,"class","svelte-k3yb6l"),B(u,"type","number"),B(u,"name","height"),u.disabled=!0,B(u,"class","svelte-k3yb6l"),B(m,"for","count"),B(m,"class","svelte-k3yb6l"),B(a,"type","number"),B(a,"name","count"),a.disabled=!0,B(a,"class","svelte-k3yb6l")},m(f,w){O(f,t,w),O(f,l,w),Q(l,i[0]),O(f,r,w),O(f,s,w),O(f,o,w),O(f,u,w),Q(u,i[1]),O(f,c,w),O(f,p,w),O(f,m,w),O(f,a,w),Q(a,i[2]),d||(v=[F(l,"input",i[10]),F(u,"input",i[11]),F(a,"input",i[12])],d=!0)},p(f,w){w&1&&Y(l.value)!==f[0]&&Q(l,f[0]),w&2&&Y(u.value)!==f[1]&&Q(u,f[1]),w&4&&Y(a.value)!==f[2]&&Q(a,f[2])},d(f){f&&(y(t),y(l),y(r),y(s),y(o),y(u),y(c),y(p),y(m),y(a)),d=!1,ct(v)}}}function Yt(i){let t,n,l,r,s,o,e,u,c,p,m,U,a,d,v,f,w,P,z,T,k,K,g,L,j,_,h,N,I,D="<code>OK</code>",b,V,$,it=rt(Object.keys(i[4])),G=[];for(let A=0;A<it.length;A+=1)G[A]=Ot(It(i,it,A));function Et(A,J){return A[3]in A[4]?Wt:Qt}let bt=Et(i),tt=bt(i);return b=zt(i[8][0]),{c(){t=x("div"),n=x("label"),l=x("code"),r=H("Level "),s=x("button"),o=x("code"),e=H(i[3]),u=H(": "),c=H(i[0]),p=H("x"),m=H(i[1]),U=H(","),a=H(i[2]),d=R(),v=x("dialog"),f=x("div");for(let A=0;A<G.length;A+=1)G[A].c();w=R(),P=x("label"),z=x("input"),T=H("customize"),k=x("br"),K=H(" "),g=R(),L=x("div"),tt.c(),j=R(),_=x("br"),h=H(" "),N=R(),I=x("button"),I.innerHTML=D,this.h()},l(A){t=C(A,"DIV",{});var J=q(t);n=C(J,"LABEL",{});var M=q(n);l=C(M,"CODE",{});var W=q(l);r=X(W,"Level "),s=C(W,"BUTTON",{});var Tt=q(s);o=C(Tt,"CODE",{});var Bt=q(o);e=X(Bt,i[3]),Bt.forEach(y),Tt.forEach(y),u=X(W,": "),c=X(W,i[0]),p=X(W,"x"),m=X(W,i[1]),U=X(W,","),a=X(W,i[2]),W.forEach(y),M.forEach(y),d=S(J),v=C(J,"DIALOG",{id:!0});var st=q(v);f=C(st,"DIV",{});var ot=q(f);for(let kt=0;kt<G.length;kt+=1)G[kt].l(ot);w=S(ot),P=C(ot,"LABEL",{});var wt=q(P);z=C(wt,"INPUT",{type:!0,name:!0}),T=X(wt,"customize"),wt.forEach(y),k=C(ot,"BR",{}),K=X(ot," "),ot.forEach(y),g=S(st),L=C(st,"DIV",{});var mt=q(L);tt.l(mt),j=S(mt),_=C(mt,"BR",{}),h=X(mt," "),mt.forEach(y),N=S(st),I=C(st,"BUTTON",{"data-svelte-h":!0}),Z(I)!=="svelte-hzki6z"&&(I.innerHTML=D),st.forEach(y),J.forEach(y),this.h()},h(){B(z,"type","radio"),B(z,"name","level"),z.__value="customize",Q(z,z.__value),B(v,"id","opt_dlg"),b.p(z)},m(A,J){O(A,t,J),E(t,n),E(n,l),E(l,r),E(l,s),E(s,o),E(o,e),E(l,u),E(l,c),E(l,p),E(l,m),E(l,U),E(l,a),E(t,d),E(t,v),E(v,f);for(let M=0;M<G.length;M+=1)G[M]&&G[M].m(f,null);E(f,w),E(f,P),E(P,z),z.checked=z.__value===i[3],E(P,T),E(f,k),E(f,K),E(v,g),E(v,L),tt.m(L,null),E(L,j),E(L,_),E(L,h),E(v,N),E(v,I),V||($=[F(s,"click",Zt),F(z,"change",i[9]),F(z,"change",i[5]),F(I,"click",i[6])],V=!0)},p(A,[J]){if(J&8&&ut(e,A[3]),J&1&&ut(c,A[0]),J&2&&ut(m,A[1]),J&4&&ut(a,A[2]),J&56){it=rt(Object.keys(A[4]));let M;for(M=0;M<it.length;M+=1){const W=It(A,it,M);G[M]?G[M].p(W,J):(G[M]=Ot(W),G[M].c(),G[M].m(f,w))}for(;M<G.length;M+=1)G[M].d(1);G.length=it.length}J&8&&(z.checked=z.__value===A[3]),bt===(bt=Et(A))&&tt?tt.p(A,J):(tt.d(1),tt=bt(A),tt&&(tt.c(),tt.m(L,j)))},i:lt,o:lt,d(A){A&&y(t),Ct(G,A),tt.d(),b.r(),V=!1,ct($)}}}function Zt(){document.querySelector("dialog#opt_dlg").showModal()}function $t(i,t,n){const l={easy:{width:8,height:8,count:10},medium:{width:16,height:16,count:40},export:{width:30,height:16,count:99}};let r="medium",{width:s=16}=t,{height:o=16}=t,{count:e=40}=t;function u(){if(r in l){const T=l[r];n(0,s=T.width),n(1,o=T.height),n(2,e=T.count)}}const c=jt();function p(){document.querySelector("dialog#opt_dlg").close(),c("change")}const m=[[]];function U(){r=this.__value,n(3,r)}function a(){r=this.__value,n(3,r)}function d(){s=Y(this.value),n(0,s)}function v(){o=Y(this.value),n(1,o)}function f(){e=Y(this.value),n(2,e)}function w(){s=Y(this.value),n(0,s)}function P(){o=Y(this.value),n(1,o)}function z(){e=Y(this.value),n(2,e)}return i.$$set=T=>{"width"in T&&n(0,s=T.width),"height"in T&&n(1,o=T.height),"count"in T&&n(2,e=T.count)},[s,o,e,r,l,u,p,U,m,a,d,v,f,w,P,z]}class te extends at{constructor(t){super(),ht(this,t,$t,Yt,ft,{width:0,height:1,count:2})}get width(){return this.$$.ctx[0]}set width(t){this.$$set({width:t}),xt()}get height(){return this.$$.ctx[1]}set height(t){this.$$set({height:t}),xt()}get count(){return this.$$.ctx[2]}set count(t){this.$$set({count:t}),xt()}}function ee(i){let t,n,l=i[0]/1e3+"",r,s;return{c(){t=x("code"),n=H("Elapsed: "),r=H(l),s=H(" seconds")},l(o){t=C(o,"CODE",{});var e=q(t);n=X(e,"Elapsed: "),r=X(e,l),s=X(e," seconds"),e.forEach(y)},m(o,e){O(o,t,e),E(t,n),E(t,r),E(t,s)},p(o,[e]){e&1&&l!==(l=o[0]/1e3+"")&&ut(r,l)},i:lt,o:lt,d(o){o&&y(t)}}}function ne(i,t,n){let l=0,r=0,s=0,o,e=0;function u(){l=0,s=0,r=0,n(0,e=0),o&&(clearInterval(o),o=null)}function c(){u(),l=Date.now(),o=setInterval(()=>n(0,e=m()),100)}function p(){s=Date.now(),n(0,e=m()),o&&(clearInterval(o),o=null)}function m(){return l==0?0:s!=0?s+r-l:Date.now()+r-l}return[e,u,c,p]}class le extends at{constructor(t){super(),ht(this,t,ne,ee,ft,{reset:1,start:2,stop:3})}get reset(){return this.$$.ctx[1]}get start(){return this.$$.ctx[2]}get stop(){return this.$$.ctx[3]}}function Nt(i,t,n){const l=i.slice();return l[25]=t[n],l}function Ut(i,t,n){const l=i.slice();return l[28]=t[n],l[29]=t,l[30]=n,l}function Dt(i){let t,n,l;const r=[i[28]];function s(e){i[16](e,i[28])}let o={};for(let e=0;e<r.length;e+=1)o=qt(o,r[e]);return i[28].status!==void 0&&(o.status=i[28].status),t=new Kt({props:o}),yt.push(()=>Ft(t,"status",s)),t.$on("flag",i[5]),t.$on("unflag",i[6]),t.$on("confirm",i[7]),t.$on("init",i[8]),t.$on("fail",i[9]),{c(){_t(t.$$.fragment)},l(e){dt(t.$$.fragment,e)},m(e,u){gt(t,e,u),l=!0},p(e,u){i=e;const c=u&8?Gt(r,[Ht(i[28])]):{};!n&&u&8&&(n=!0,c.status=i[28].status,Vt(()=>n=!1)),t.$set(c)},i(e){l||(et(t.$$.fragment,e),l=!0)},o(e){nt(t.$$.fragment,e),l=!1},d(e){pt(t,e)}}}function At(i){let t,n,l,r=rt(i[25]),s=[];for(let e=0;e<r.length;e+=1)s[e]=Dt(Ut(i,r,e));const o=e=>nt(s[e],1,1,()=>{s[e]=null});return{c(){t=x("div");for(let e=0;e<s.length;e+=1)s[e].c();n=R(),this.h()},l(e){t=C(e,"DIV",{class:!0});var u=q(t);for(let c=0;c<s.length;c+=1)s[c].l(u);n=S(u),u.forEach(y),this.h()},h(){B(t,"class","row svelte-73hlw")},m(e,u){O(e,t,u);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null);E(t,n),l=!0},p(e,u){if(u&1e3){r=rt(e[25]);let c;for(c=0;c<r.length;c+=1){const p=Ut(e,r,c);s[c]?(s[c].p(p,u),et(s[c],1)):(s[c]=Dt(p),s[c].c(),et(s[c],1),s[c].m(t,n))}for(Mt(),c=r.length;c<s.length;c+=1)o(c);Rt()}},i(e){if(!l){for(let u=0;u<r.length;u+=1)et(s[u]);l=!0}},o(e){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)nt(s[u]);l=!1},d(e){e&&y(t),Ct(s,e)}}}function ie(i){let t,n,l,r,s,o,e,u,c,p,m,U="restart",a,d,v,f,w,P={};t=new te({props:P}),i[14](t),t.$on("change",i[0]);let z={};u=new le({props:z}),i[15](u);let T=rt(i[3]),k=[];for(let g=0;g<T.length;g+=1)k[g]=At(Nt(i,T,g));const K=g=>nt(k[g],1,1,()=>{k[g]=null});return{c(){_t(t.$$.fragment),n=R(),l=x("p"),r=x("code"),s=H("Remain: "),o=H(i[4]),e=R(),_t(u.$$.fragment),c=R(),p=x("p"),m=x("button"),m.textContent=U,a=R(),d=x("div");for(let g=0;g<k.length;g+=1)k[g].c()},l(g){dt(t.$$.fragment,g),n=S(g),l=C(g,"P",{});var L=q(l);r=C(L,"CODE",{});var j=q(r);s=X(j,"Remain: "),o=X(j,i[4]),j.forEach(y),e=S(L),dt(u.$$.fragment,L),L.forEach(y),c=S(g),p=C(g,"P",{});var _=q(p);m=C(_,"BUTTON",{"data-svelte-h":!0}),Z(m)!=="svelte-5dldn0"&&(m.textContent=U),_.forEach(y),a=S(g),d=C(g,"DIV",{});var h=q(d);for(let N=0;N<k.length;N+=1)k[N].l(h);h.forEach(y)},m(g,L){gt(t,g,L),O(g,n,L),O(g,l,L),E(l,r),E(r,s),E(r,o),E(l,e),gt(u,l,null),O(g,c,L),O(g,p,L),E(p,m),O(g,a,L),O(g,d,L);for(let j=0;j<k.length;j+=1)k[j]&&k[j].m(d,null);v=!0,f||(w=F(m,"click",i[0]),f=!0)},p(g,[L]){const j={};t.$set(j),(!v||L&16)&&ut(o,g[4]);const _={};if(u.$set(_),L&1e3){T=rt(g[3]);let h;for(h=0;h<T.length;h+=1){const N=Nt(g,T,h);k[h]?(k[h].p(N,L),et(k[h],1)):(k[h]=At(N),k[h].c(),et(k[h],1),k[h].m(d,null))}for(Mt(),h=T.length;h<k.length;h+=1)K(h);Rt()}},i(g){if(!v){et(t.$$.fragment,g),et(u.$$.fragment,g);for(let L=0;L<T.length;L+=1)et(k[L]);v=!0}},o(g){nt(t.$$.fragment,g),nt(u.$$.fragment,g),k=k.filter(Boolean);for(let L=0;L<k.length;L+=1)nt(k[L]);v=!1},d(g){g&&(y(n),y(l),y(c),y(p),y(a),y(d)),i[14](null),pt(t,g),i[15](null),pt(u),Ct(k,g),f=!1,w()}}}function se(i){switch(i.status){case"init":return" ";case"mark":return"F";case"clear":return i.value;default:return"X"}}function oe(i,t,n){let l={width:16,height:16,count:40},r={};const s=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];function o(_,h){let N=0;for(let I of s){const D=_+I[0],b=h+I[1];0<=D&&D<l.width&&0<=b&&b<l.height&&e[b][D].value==-1&&++N}return N}let e,u,c;d();function p(_,h){n(4,--c)}function m(_,h){n(4,++c)}function U(_,h){let N=0;for(let I of s){const D=_+I[0],b=h+I[1];0<=D&&D<l.width&&0<=b&&b<l.height&&e[b][D].status=="mark"&&++N}return N}function a(_){const h=[[_.detail.x,_.detail.y]];for(;h.length>0;){const N=h.pop(),I=N[0],D=N[1];if(U(I,D)==e[D][I].value)for(let b of s){const V=I+b[0],$=D+b[1];0<=V&&V<l.width&&0<=$&&$<l.height&&e[$][V].status=="init"&&(e[$][V].value>=0?n(3,e[$][V].status="clear",e):(n(3,e[$][V].status="fail",e),f()),e[$][V].value==0&&h.push([V,$]))}}}function d(){u="working",n(3,e=[]);for(let _=0;_<l.height;++_){n(3,e[_]=[],e);for(let h=0;h<l.width;++h)n(3,e[_][h]={x:h,y:_,status:"init",value:null,is_init:!1,freeze:!1},e)}n(4,c=l.count),r.reset&&r.reset()}function v(_){const h=_.detail.x,N=_.detail.y;let I=0;for(;I<l.count;){const D=Math.floor(Math.random()*l.width),b=Math.floor(Math.random()*l.height);h-1<=D&&D<=h+1&&N-1<=b&&b<=N+1||e[b][D].value==null&&(n(3,e[b][D].value=-1,e),I++)}for(let D=0;D<l.height;++D)for(let b=0;b<l.width;++b)n(3,e[D][b].is_init=!0,e),e[D][b].value==null&&n(3,e[D][b].value=o(b,D),e);n(3,e[N][h].status="clear",e),a({detail:{x:h,y:N}}),r.start()}function f(){r.stop(),u="failure";for(let _=0;_<l.height;++_)for(let h=0;h<l.width;++h)n(3,e[_][h].freeze=!0,e)}function w(){return u!="working"||c>0||P()||(r.stop(),u="success"),u}function P(){for(const _ of e)for(const h of _)if(h.status=="init")return!0;return!1}function z(){return{status:w(),count:l.count,remain:c,width:l.width,height:l.height,data:e.map(_=>_.map(se))}}function T(_,h){e[h][_].status=="init"&&(n(4,--c),n(3,e[h][_].status="mark",e))}function k(_,h){e[h][_].status=="init"&&(e[h][_].value>=0?n(3,e[h][_].status="clear",e):(n(3,e[h][_].status="fail",e),f())),document.querySelector(`button#c-${_}-${h}`).click()}function K(){navigator.clipboard.writeText(JSON.stringify(e))}function g(_){yt[_?"unshift":"push"](()=>{l=_,n(1,l)})}function L(_){yt[_?"unshift":"push"](()=>{r=_,n(2,r)})}function j(_,h){i.$$.not_equal(h.status,_)&&(h.status=_,n(3,e))}return[d,l,r,e,c,p,m,a,v,f,z,T,k,K,g,L,j]}class ue extends at{constructor(t){super(),ht(this,t,oe,ie,ft,{restart:0,view:10,mark:11,dig:12,do_copy:13})}get restart(){return this.$$.ctx[0]}get view(){return this.$$.ctx[10]}get mark(){return this.$$.ctx[11]}get dig(){return this.$$.ctx[12]}get do_copy(){return this.$$.ctx[13]}}function re(i){let t,n,l,r,s="Go",o,e,u="Step",c,p,m="Guess",U,a;return{c(){t=x("div"),n=x("p"),l=R(),r=x("button"),r.textContent=s,o=R(),e=x("button"),e.textContent=u,c=R(),p=x("button"),p.textContent=m},l(d){t=C(d,"DIV",{});var v=q(t);n=C(v,"P",{}),q(n).forEach(y),l=S(v),r=C(v,"BUTTON",{"data-svelte-h":!0}),Z(r)!=="svelte-cs1isw"&&(r.textContent=s),o=S(v),e=C(v,"BUTTON",{"data-svelte-h":!0}),Z(e)!=="svelte-15ylncw"&&(e.textContent=u),c=S(v),p=C(v,"BUTTON",{"data-svelte-h":!0}),Z(p)!=="svelte-1m2zc6s"&&(p.textContent=m),v.forEach(y)},m(d,v){O(d,t,v),E(t,n),E(t,l),E(t,r),E(t,o),E(t,e),E(t,c),E(t,p),U||(a=[F(r,"click",i[1]),F(e,"click",i[0]),F(p,"click",i[3])],U=!0)},p:lt,i:lt,o:lt,d(d){d&&y(t),U=!1,ct(a)}}}function*fe(i,t,n){for(const l of[-2,-1]){const r=n+l;if(!(r<0))for(const s of[-2,-1,0,1,2]){const o=t+s;0<=o&&o<i.width&&(yield{x:o,y:r})}}for(const l of[0]){const r=n+l;for(const s of[-2,-1]){const o=t+s;o>=0&&(yield{x:o,y:r})}}}function ce(i){const t=[];for(let n=0;n<i.height;++n)for(let l=0;l<i.width;++l)i.data[n][l]===" "&&t.push({x:l,y:n});return{cells:t,min:i.remain,max:i.remain}}function vt(i,t){return i.find(n=>n.x===t.x&&n.y===t.y)!=null}function ae(i,t){return i.length==t.length&&i.every(n=>vt(t,n))&&t.every(n=>vt(i,n))}function Pt(i){for(let t=i.length-2;t>=0;--t)for(let n=i.length-1;n>t;--n)ae(i[t].cells,i[n].cells)&&(i[t].min=Math.max(i[t].min,i[n].min),i[t].max=Math.min(i[t].max,i[n].max),i[n]=i[i.length-1],i.length--)}function he(i){const t=[];for(const r of i){const s=(r.min+r.max)/r.cells.length;for(const o of r.cells){let e;o.y in t?e=t[o.y]:(e=[],t[o.y]=e),o.x in e?s>e[o.x]&&(e[o.x]=s):e[o.x]=s}}let n=4,l;for(const[r,s]of t.entries())if(s!=null)for(const[o,e]of s.entries())e!=null&&e<n&&(n=e,l={x:o,y:r});return l}function me(i,t,n){let{field:l}=t;const r=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];function*s(a,d,v){for(let f of r){const w=d+f[0],P=v+f[1];0<=w&&w<a.width&&0<=P&&P<a.height&&(yield{x:w,y:P})}}function o(a,d,v,f){let w=0;for(const P of s(a,d,v))f(a.data[P.y][P.x])&&++w;return w}function e(a,d,v,f){const w=[];for(const P of s(a,d,v))f(a.data[P.y][P.x])&&w.push(P);return w}function u(a){const d=l.view();if(d.status!="working")return!1;const v=c(d,a);if(!v||v.length==0)return!1;for(const f of v)switch(f.op){case"dig":l.dig(f.x,f.y);break;case"mark":l.mark(f.x,f.y)}return!0}function c(a,d){return p(a,d)}function p(a,d){const v=[ce(a)];if(v[0].cells.length==a.height*a.width)return[{op:"dig",x:Math.floor(a.width/2),y:Math.floor(a.height/2)}];const f={};for(let T=0;T<a.height;++T)for(let k=0;k<a.width;++k)if(typeof a.data[T][k]=="number"){const K=a.data[T][k],g=e(a,k,T,h=>h===" ");if(g.length==0)continue;const L=o(a,k,T,h=>h==="F"),j=K-L,_={cells:g,min:j,max:j};v.push(_),f[`${k},${T}`]=[_]}for(let T=0;T<a.height;++T)for(let k=0;k<a.width;++k){const K=f[`${k},${T}`];if(K==null)continue;const g=K[0];for(const L of fe(a,k,T)){const j=f[`${L.x},${L.y}`];if(j!=null)for(const _ of[...j,v[0]]){const h={cells:[]},N={cells:[]},I={cells:[]};for(const b of g.cells)vt(_.cells,b)?I.cells.push(b):h.cells.push(b);if(I.cells.length===0)continue;for(const b of _.cells)vt(I.cells,b)||N.cells.push(b);if(N.cells.length==0&&h.cells.length==0)continue;for(const b of[h,N,I])b.min=0,b.max=b.cells.length;let D=!1;for(;!D;){let b=!1;for(const V of[g.max-h.min,_.max-N.min])V<I.max&&(I.max=V,b=!0);for(const V of[g.min-h.max,_.min-N.max])V>I.min&&(I.min=V,b=!0);g.max-I.min<h.max&&(h.max=g.max-I.min,b=!0),g.min-I.max>h.min&&(h.min=g.min-I.max,b=!0),_.max-I.min<N.max&&(N.max=_.max-I.min,b=!0),_.min-I.max>N.min&&(N.min=_.min-I.max,b=!0),D=!b}[I,h,N].filter(b=>b.cells.length>0).forEach(b=>v.push(b)),[I,h].filter(b=>b.cells.length>0).forEach(b=>K.push(b)),Pt(K),_!==v[0]&&([I,N].filter(b=>b.cells.length>0).forEach(b=>j.push(b)),Pt(j))}}}let w=v.filter(T=>T.cells.length==T.min),P=[];for(const T of w)for(const k of T.cells)P.push({op:"mark",x:k.x,y:k.y});w=v.filter(T=>T.max==0);for(const T of w)for(const k of T.cells)P.push({op:"dig",x:k.x,y:k.y});if(P.length>0)return P;if(!d)return[];const z=he(v);return z.op="dig",[z]}async function m(){setTimeout(()=>{u()&&m()},20)}const U=()=>u(!0);return i.$$set=a=>{"field"in a&&n(2,l=a.field)},[u,m,l,U]}class _e extends at{constructor(t){super(),ht(this,t,me,re,ft,{field:2})}}function de(i){let t,n,l,r,s,o,e,u="github source code",c,p={};return t=new ue({props:p}),i[1](t),l=new _e({props:{field:i[0]}}),{c(){_t(t.$$.fragment),n=R(),_t(l.$$.fragment),r=R(),s=x("br"),o=R(),e=x("a"),e.textContent=u,this.h()},l(m){dt(t.$$.fragment,m),n=S(m),dt(l.$$.fragment,m),r=S(m),s=C(m,"BR",{}),o=S(m),e=C(m,"A",{href:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1iae31h"&&(e.textContent=u),this.h()},h(){B(e,"href","https://github.com/fishautumn/mine")},m(m,U){gt(t,m,U),O(m,n,U),gt(l,m,U),O(m,r,U),O(m,s,U),O(m,o,U),O(m,e,U),c=!0},p(m,[U]){const a={};t.$set(a);const d={};U&1&&(d.field=m[0]),l.$set(d)},i(m){c||(et(t.$$.fragment,m),et(l.$$.fragment,m),c=!0)},o(m){nt(t.$$.fragment,m),nt(l.$$.fragment,m),c=!1},d(m){m&&(y(n),y(r),y(s),y(o),y(e)),i[1](null),pt(t,m),pt(l,m)}}}function ge(i,t,n){let l;function r(s){yt[s?"unshift":"push"](()=>{l=s,n(0,l)})}return[l,r]}class ye extends at{constructor(t){super(),ht(this,t,ge,de,ft,{})}}export{ye as component};
