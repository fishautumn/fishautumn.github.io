import{s as ct,e as x,d as C,f as S,i as b,O as Lt,v as I,k as M,l as w,P as q,Q as zt,n as lt,A as ft,R as At,C as wt,S as Pt,t as G,b as j,h as F,j as H,T as Q,U as K,m as ut,V as xt,W as Y,x as vt,X as St,Y as qt}from"../chunks/scheduler.Bnapz6z0.js";import{S as at,i as ht,b as dt,d as mt,m as gt,t as tt,g as Rt,c as jt,a as nt,e as pt,f as Vt}from"../chunks/index.DElnCtB0.js";function rt(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function Gt(s,e){const l={},n={},c={$$scope:1};let o=s.length;for(;o--;){const u=s[o],t=e[o];if(t){for(const r in u)r in t||(n[r]=1);for(const r in t)c[r]||(l[r]=t[r],c[r]=1);s[o]=t}else for(const r in u)c[r]=1}for(const u in n)u in l||(l[u]=void 0);return l}function Ft(s){return typeof s=="object"&&s!==null?s:{}}function Xt(s){let e,l,n,c,o,u;return{c(){e=x("button"),l=x("img"),this.h()},l(t){e=C(t,"BUTTON",{id:!0,class:!0});var r=S(e);l=C(r,"IMG",{src:!0,alt:!0,class:!0}),r.forEach(b),this.h()},h(){Lt(l.src,n=s[2])||I(l,"src",n),I(l,"alt",""),I(l,"class","svelte-4wjcsy"),I(e,"id",c=`c-${s[0]}-${s[1]}`),I(e,"class","svelte-4wjcsy")},m(t,r){M(t,e,r),w(e,l),o||(u=[q(e,"click",s[3]),q(e,"contextmenu",zt(s[8]))],o=!0)},p(t,[r]){r&4&&!Lt(l.src,n=t[2])&&I(l,"src",n),r&3&&c!==(c=`c-${t[0]}-${t[1]}`)&&I(e,"id",c)},i:lt,o:lt,d(t){t&&b(e),o=!1,ft(u)}}}function Jt(s,e,l){let n,{value:c}=e,{x:o}=e,{y:u}=e,{status:t}=e,{is_init:r}=e,{freeze:f}=e;const y=At(),h={init:"init",clear:c,mark:"flag",fail:"mine-red",wrong:"flag-red"};function N(T){f||(r?t=="init"?T.button==0?c==-1?(l(4,t="fail"),y("fail",{x:o,y:u})):(l(4,t="clear"),c==0&&y("confirm",{x:o,y:u})):T.button==2&&(y("flag",{x:o,y:u}),l(4,t="mark")):t=="clear"&&c>0?y("confirm",{x:o,y:u}):t=="mark"&&T.button==2&&(y("unflag",{x:o,y:u}),l(4,t="init")):(l(5,r=!0),y("init",{x:o,y:u})))}const k=()=>N({button:2});return s.$$set=T=>{"value"in T&&l(6,c=T.value),"x"in T&&l(0,o=T.x),"y"in T&&l(1,u=T.y),"status"in T&&l(4,t=T.status),"is_init"in T&&l(5,r=T.is_init),"freeze"in T&&l(7,f=T.freeze)},s.$$.update=()=>{s.$$.dirty&80&&l(2,n=(h[t]??c??"init")+".svg")},[o,u,n,N,t,r,c,f,k]}class Kt extends at{constructor(e){super(),ht(this,e,Jt,Xt,ct,{value:6,x:0,y:1,status:4,is_init:5,freeze:7})}}function Bt(s,e,l){const n=s.slice();return n[17]=e[l],n}function It(s){let e,l,n=s[17]+"",c,o,u,t,r;return u=Pt(s[8][0]),{c(){e=x("label"),l=x("input"),c=G(n),o=x("br"),this.h()},l(f){e=C(f,"LABEL",{});var y=S(e);l=C(y,"INPUT",{type:!0,name:!0}),c=F(y,n),y.forEach(b),o=C(f,"BR",{}),this.h()},h(){I(l,"type","radio"),I(l,"name","level"),l.__value=s[17],K(l,l.__value),u.p(l)},m(f,y){M(f,e,y),w(e,l),l.checked=l.__value===s[3],w(e,c),M(f,o,y),t||(r=[q(l,"change",s[7]),q(l,"change",s[5])],t=!0)},p(f,y){y&8&&(l.checked=l.__value===f[3])},d(f){f&&(b(e),b(o)),u.r(),t=!1,ft(r)}}}function Qt(s){let e,l="width: ",n,c,o,u,t="height: ",r,f,y,h,N="count: ",k,T,D;return{c(){e=x("label"),e.textContent=l,n=x("input"),c=x("br"),o=j(),u=x("label"),u.textContent=t,r=x("input"),f=x("br"),y=j(),h=x("label"),h.textContent=N,k=x("input"),this.h()},l(i){e=C(i,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1fdanlc"&&(e.textContent=l),n=C(i,"INPUT",{type:!0,name:!0,class:!0}),c=C(i,"BR",{}),o=H(i),u=C(i,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Q(u)!=="svelte-19r74aw"&&(u.textContent=t),r=C(i,"INPUT",{type:!0,name:!0,class:!0}),f=C(i,"BR",{}),y=H(i),h=C(i,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Q(h)!=="svelte-t2iefa"&&(h.textContent=N),k=C(i,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){I(e,"for","width"),I(e,"class","svelte-k3yb6l"),I(n,"type","number"),I(n,"name","width"),I(n,"class","svelte-k3yb6l"),I(u,"for","height"),I(u,"class","svelte-k3yb6l"),I(r,"type","number"),I(r,"name","height"),I(r,"class","svelte-k3yb6l"),I(h,"for","count"),I(h,"class","svelte-k3yb6l"),I(k,"type","number"),I(k,"name","count"),I(k,"class","svelte-k3yb6l")},m(i,g){M(i,e,g),M(i,n,g),K(n,s[0]),M(i,c,g),M(i,o,g),M(i,u,g),M(i,r,g),K(r,s[1]),M(i,f,g),M(i,y,g),M(i,h,g),M(i,k,g),K(k,s[2]),T||(D=[q(n,"input",s[13]),q(r,"input",s[14]),q(k,"input",s[15])],T=!0)},p(i,g){g&1&&Y(n.value)!==i[0]&&K(n,i[0]),g&2&&Y(r.value)!==i[1]&&K(r,i[1]),g&4&&Y(k.value)!==i[2]&&K(k,i[2])},d(i){i&&(b(e),b(n),b(c),b(o),b(u),b(r),b(f),b(y),b(h),b(k)),T=!1,ft(D)}}}function Wt(s){let e,l="width: ",n,c,o,u,t="height: ",r,f,y,h,N="count: ",k,T,D;return{c(){e=x("label"),e.textContent=l,n=x("input"),c=x("br"),o=j(),u=x("label"),u.textContent=t,r=x("input"),f=x("br"),y=j(),h=x("label"),h.textContent=N,k=x("input"),this.h()},l(i){e=C(i,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1fdanlc"&&(e.textContent=l),n=C(i,"INPUT",{type:!0,name:!0,class:!0}),c=C(i,"BR",{}),o=H(i),u=C(i,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Q(u)!=="svelte-19r74aw"&&(u.textContent=t),r=C(i,"INPUT",{type:!0,name:!0,class:!0}),f=C(i,"BR",{}),y=H(i),h=C(i,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Q(h)!=="svelte-t2iefa"&&(h.textContent=N),k=C(i,"INPUT",{type:!0,name:!0,class:!0}),this.h()},h(){I(e,"for","width"),I(e,"class","svelte-k3yb6l"),I(n,"type","number"),I(n,"name","width"),n.disabled=!0,I(n,"class","svelte-k3yb6l"),I(u,"for","height"),I(u,"class","svelte-k3yb6l"),I(r,"type","number"),I(r,"name","height"),r.disabled=!0,I(r,"class","svelte-k3yb6l"),I(h,"for","count"),I(h,"class","svelte-k3yb6l"),I(k,"type","number"),I(k,"name","count"),k.disabled=!0,I(k,"class","svelte-k3yb6l")},m(i,g){M(i,e,g),M(i,n,g),K(n,s[0]),M(i,c,g),M(i,o,g),M(i,u,g),M(i,r,g),K(r,s[1]),M(i,f,g),M(i,y,g),M(i,h,g),M(i,k,g),K(k,s[2]),T||(D=[q(n,"input",s[10]),q(r,"input",s[11]),q(k,"input",s[12])],T=!0)},p(i,g){g&1&&Y(n.value)!==i[0]&&K(n,i[0]),g&2&&Y(r.value)!==i[1]&&K(r,i[1]),g&4&&Y(k.value)!==i[2]&&K(k,i[2])},d(i){i&&(b(e),b(n),b(c),b(o),b(u),b(r),b(f),b(y),b(h),b(k)),T=!1,ft(D)}}}function Yt(s){let e,l,n,c,o,u,t,r,f,y,h,N,k,T,D,i,g,O,E,L,m,et,_,v,A,d,a,U,P,p="<code>OK</code>",B,X,Z,st=rt(Object.keys(s[4])),V=[];for(let R=0;R<st.length;R+=1)V[R]=It(Bt(s,st,R));function Ct(R,J){return R[3]in R[4]?Wt:Qt}let bt=Ct(s),$=bt(s);return B=Pt(s[8][0]),{c(){e=x("div"),l=x("label"),n=x("code"),c=G("Level "),o=x("button"),u=x("code"),t=G(s[3]),r=G(": "),f=G(s[0]),y=G("x"),h=G(s[1]),N=G(","),k=G(s[2]),T=j(),D=x("dialog"),i=x("div");for(let R=0;R<V.length;R+=1)V[R].c();g=j(),O=x("label"),E=x("input"),L=G("custom"),m=x("br"),et=G(" "),_=j(),v=x("div"),$.c(),A=j(),d=x("br"),a=G(" "),U=j(),P=x("button"),P.innerHTML=p,this.h()},l(R){e=C(R,"DIV",{});var J=S(e);l=C(J,"LABEL",{});var z=S(l);n=C(z,"CODE",{});var W=S(n);c=F(W,"Level "),o=C(W,"BUTTON",{});var Tt=S(o);u=C(Tt,"CODE",{});var Et=S(u);t=F(Et,s[3]),Et.forEach(b),Tt.forEach(b),r=F(W,": "),f=F(W,s[0]),y=F(W,"x"),h=F(W,s[1]),N=F(W,","),k=F(W,s[2]),W.forEach(b),z.forEach(b),T=H(J),D=C(J,"DIALOG",{id:!0});var it=S(D);i=C(it,"DIV",{});var ot=S(i);for(let kt=0;kt<V.length;kt+=1)V[kt].l(ot);g=H(ot),O=C(ot,"LABEL",{});var yt=S(O);E=C(yt,"INPUT",{type:!0,name:!0}),L=F(yt,"custom"),yt.forEach(b),m=C(ot,"BR",{}),et=F(ot," "),ot.forEach(b),_=H(it),v=C(it,"DIV",{});var _t=S(v);$.l(_t),A=H(_t),d=C(_t,"BR",{}),a=F(_t," "),_t.forEach(b),U=H(it),P=C(it,"BUTTON",{"data-svelte-h":!0}),Q(P)!=="svelte-hzki6z"&&(P.innerHTML=p),it.forEach(b),J.forEach(b),this.h()},h(){I(E,"type","radio"),I(E,"name","level"),E.__value="custom",K(E,E.__value),I(D,"id","opt_dlg"),B.p(E)},m(R,J){M(R,e,J),w(e,l),w(l,n),w(n,c),w(n,o),w(o,u),w(u,t),w(n,r),w(n,f),w(n,y),w(n,h),w(n,N),w(n,k),w(e,T),w(e,D),w(D,i);for(let z=0;z<V.length;z+=1)V[z]&&V[z].m(i,null);w(i,g),w(i,O),w(O,E),E.checked=E.__value===s[3],w(O,L),w(i,m),w(i,et),w(D,_),w(D,v),$.m(v,null),w(v,A),w(v,d),w(v,a),w(D,U),w(D,P),X||(Z=[q(o,"click",Zt),q(E,"change",s[9]),q(E,"change",s[5]),q(P,"click",s[6])],X=!0)},p(R,[J]){if(J&8&&ut(t,R[3]),J&1&&ut(f,R[0]),J&2&&ut(h,R[1]),J&4&&ut(k,R[2]),J&56){st=rt(Object.keys(R[4]));let z;for(z=0;z<st.length;z+=1){const W=Bt(R,st,z);V[z]?V[z].p(W,J):(V[z]=It(W),V[z].c(),V[z].m(i,g))}for(;z<V.length;z+=1)V[z].d(1);V.length=st.length}J&8&&(E.checked=E.__value===R[3]),bt===(bt=Ct(R))&&$?$.p(R,J):($.d(1),$=bt(R),$&&($.c(),$.m(v,A)))},i:lt,o:lt,d(R){R&&b(e),xt(V,R),$.d(),B.r(),X=!1,ft(Z)}}}function Zt(){document.querySelector("dialog#opt_dlg").showModal()}function $t(s,e,l){const n={easy:{width:8,height:8,count:10},medium:{width:16,height:16,count:40},expert:{width:30,height:16,count:99}};let c="medium",{width:o=16}=e,{height:u=16}=e,{count:t=40}=e;function r(){if(c in n){const L=n[c];l(0,o=L.width),l(1,u=L.height),l(2,t=L.count)}}const f=At();function y(){document.querySelector("dialog#opt_dlg").close(),f("change")}const h=[[]];function N(){c=this.__value,l(3,c)}function k(){c=this.__value,l(3,c)}function T(){o=Y(this.value),l(0,o)}function D(){u=Y(this.value),l(1,u)}function i(){t=Y(this.value),l(2,t)}function g(){o=Y(this.value),l(0,o)}function O(){u=Y(this.value),l(1,u)}function E(){t=Y(this.value),l(2,t)}return s.$$set=L=>{"width"in L&&l(0,o=L.width),"height"in L&&l(1,u=L.height),"count"in L&&l(2,t=L.count)},[o,u,t,c,n,r,y,N,h,k,T,D,i,g,O,E]}class te extends at{constructor(e){super(),ht(this,e,$t,Yt,ct,{width:0,height:1,count:2})}get width(){return this.$$.ctx[0]}set width(e){this.$$set({width:e}),wt()}get height(){return this.$$.ctx[1]}set height(e){this.$$set({height:e}),wt()}get count(){return this.$$.ctx[2]}set count(e){this.$$set({count:e}),wt()}}function ee(s){let e,l,n=s[0]/1e3+"",c,o;return{c(){e=x("code"),l=G("Elapsed: "),c=G(n),o=G(" seconds")},l(u){e=C(u,"CODE",{});var t=S(e);l=F(t,"Elapsed: "),c=F(t,n),o=F(t," seconds"),t.forEach(b)},m(u,t){M(u,e,t),w(e,l),w(e,c),w(e,o)},p(u,[t]){t&1&&n!==(n=u[0]/1e3+"")&&ut(c,n)},i:lt,o:lt,d(u){u&&b(e)}}}function ne(s,e,l){let n=0,c=0,o=0,u,t=0;function r(){n=0,o=0,c=0,l(0,t=0),u&&(clearInterval(u),u=null)}function f(){r(),n=Date.now(),u=setInterval(()=>l(0,t=h()),100)}function y(){o=Date.now(),l(0,t=h()),u&&(clearInterval(u),u=null)}function h(){return n==0?0:o!=0?o+c-n:Date.now()+c-n}return[t,r,f,y]}class le extends at{constructor(e){super(),ht(this,e,ne,ee,ct,{reset:1,start:2,stop:3})}get reset(){return this.$$.ctx[1]}get start(){return this.$$.ctx[2]}get stop(){return this.$$.ctx[3]}}function Mt(s,e,l){const n=s.slice();return n[25]=e[l],n}function Ot(s,e,l){const n=s.slice();return n[28]=e[l],n[29]=e,n[30]=l,n}function Nt(s){let e,l,n;const c=[s[28]];function o(t){s[16](t,s[28])}let u={};for(let t=0;t<c.length;t+=1)u=St(u,c[t]);return s[28].status!==void 0&&(u.status=s[28].status),e=new Kt({props:u}),vt.push(()=>Vt(e,"status",o)),e.$on("flag",s[5]),e.$on("unflag",s[6]),e.$on("confirm",s[7]),e.$on("init",s[8]),e.$on("fail",s[9]),{c(){dt(e.$$.fragment)},l(t){mt(e.$$.fragment,t)},m(t,r){gt(e,t,r),n=!0},p(t,r){s=t;const f=r&8?Gt(c,[Ft(s[28])]):{};!l&&r&8&&(l=!0,f.status=s[28].status,qt(()=>l=!1)),e.$set(f)},i(t){n||(tt(e.$$.fragment,t),n=!0)},o(t){nt(e.$$.fragment,t),n=!1},d(t){pt(e,t)}}}function Ut(s){let e,l,n,c=rt(s[25]),o=[];for(let t=0;t<c.length;t+=1)o[t]=Nt(Ot(s,c,t));const u=t=>nt(o[t],1,1,()=>{o[t]=null});return{c(){e=x("div");for(let t=0;t<o.length;t+=1)o[t].c();l=j(),this.h()},l(t){e=C(t,"DIV",{class:!0});var r=S(e);for(let f=0;f<o.length;f+=1)o[f].l(r);l=H(r),r.forEach(b),this.h()},h(){I(e,"class","row svelte-73hlw")},m(t,r){M(t,e,r);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(e,null);w(e,l),n=!0},p(t,r){if(r&1e3){c=rt(t[25]);let f;for(f=0;f<c.length;f+=1){const y=Ot(t,c,f);o[f]?(o[f].p(y,r),tt(o[f],1)):(o[f]=Nt(y),o[f].c(),tt(o[f],1),o[f].m(e,l))}for(Rt(),f=c.length;f<o.length;f+=1)u(f);jt()}},i(t){if(!n){for(let r=0;r<c.length;r+=1)tt(o[r]);n=!0}},o(t){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)nt(o[r]);n=!1},d(t){t&&b(e),xt(o,t)}}}function se(s){let e,l,n,c,o,u,t,r,f,y,h,N="restart",k,T,D,i,g,O={};e=new te({props:O}),s[14](e),e.$on("change",s[0]);let E={};r=new le({props:E}),s[15](r);let L=rt(s[3]),m=[];for(let _=0;_<L.length;_+=1)m[_]=Ut(Mt(s,L,_));const et=_=>nt(m[_],1,1,()=>{m[_]=null});return{c(){dt(e.$$.fragment),l=j(),n=x("p"),c=x("code"),o=G("Remain: "),u=G(s[4]),t=j(),dt(r.$$.fragment),f=j(),y=x("p"),h=x("button"),h.textContent=N,k=j(),T=x("div");for(let _=0;_<m.length;_+=1)m[_].c()},l(_){mt(e.$$.fragment,_),l=H(_),n=C(_,"P",{});var v=S(n);c=C(v,"CODE",{});var A=S(c);o=F(A,"Remain: "),u=F(A,s[4]),A.forEach(b),t=H(v),mt(r.$$.fragment,v),v.forEach(b),f=H(_),y=C(_,"P",{});var d=S(y);h=C(d,"BUTTON",{"data-svelte-h":!0}),Q(h)!=="svelte-5dldn0"&&(h.textContent=N),d.forEach(b),k=H(_),T=C(_,"DIV",{});var a=S(T);for(let U=0;U<m.length;U+=1)m[U].l(a);a.forEach(b)},m(_,v){gt(e,_,v),M(_,l,v),M(_,n,v),w(n,c),w(c,o),w(c,u),w(n,t),gt(r,n,null),M(_,f,v),M(_,y,v),w(y,h),M(_,k,v),M(_,T,v);for(let A=0;A<m.length;A+=1)m[A]&&m[A].m(T,null);D=!0,i||(g=q(h,"click",s[0]),i=!0)},p(_,[v]){const A={};e.$set(A),(!D||v&16)&&ut(u,_[4]);const d={};if(r.$set(d),v&1e3){L=rt(_[3]);let a;for(a=0;a<L.length;a+=1){const U=Mt(_,L,a);m[a]?(m[a].p(U,v),tt(m[a],1)):(m[a]=Ut(U),m[a].c(),tt(m[a],1),m[a].m(T,null))}for(Rt(),a=L.length;a<m.length;a+=1)et(a);jt()}},i(_){if(!D){tt(e.$$.fragment,_),tt(r.$$.fragment,_);for(let v=0;v<L.length;v+=1)tt(m[v]);D=!0}},o(_){nt(e.$$.fragment,_),nt(r.$$.fragment,_),m=m.filter(Boolean);for(let v=0;v<m.length;v+=1)nt(m[v]);D=!1},d(_){_&&(b(l),b(n),b(f),b(y),b(k),b(T)),s[14](null),pt(e,_),s[15](null),pt(r),xt(m,_),i=!1,g()}}}function ie(s){switch(s.status){case"init":return" ";case"mark":return"F";case"clear":return s.value;default:return"X"}}function oe(s,e,l){let n={width:16,height:16,count:40},c={};const o=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]];function u(d,a){let U=0;for(let P of o){const p=d+P[0],B=a+P[1];0<=p&&p<n.width&&0<=B&&B<n.height&&t[B][p].value==-1&&++U}return U}let t,r,f;T();function y(d,a){l(4,--f)}function h(d,a){l(4,++f)}function N(d,a){let U=0;for(let P of o){const p=d+P[0],B=a+P[1];0<=p&&p<n.width&&0<=B&&B<n.height&&t[B][p].status=="mark"&&++U}return U}function k(d){const a=[[d.detail.x,d.detail.y]];for(;a.length>0;){const U=a.pop(),P=U[0],p=U[1];if(N(P,p)==t[p][P].value)for(let B of o){const X=P+B[0],Z=p+B[1];0<=X&&X<n.width&&0<=Z&&Z<n.height&&t[Z][X].status=="init"&&(t[Z][X].value>=0?l(3,t[Z][X].status="clear",t):(l(3,t[Z][X].status="fail",t),i()),t[Z][X].value==0&&a.push([X,Z]))}}}function T(){r="working",l(3,t=[]);for(let d=0;d<n.height;++d){l(3,t[d]=[],t);for(let a=0;a<n.width;++a)l(3,t[d][a]={x:a,y:d,status:"init",value:null,is_init:!1,freeze:!1},t)}l(4,f=n.count),c.reset&&c.reset()}function D(d){const a=d.detail.x,U=d.detail.y;let P=0;for(;P<n.count;){const p=Math.floor(Math.random()*n.width),B=Math.floor(Math.random()*n.height);a-1<=p&&p<=a+1&&U-1<=B&&B<=U+1||t[B][p].value==null&&(l(3,t[B][p].value=-1,t),P++)}for(let p=0;p<n.height;++p)for(let B=0;B<n.width;++B)l(3,t[p][B].is_init=!0,t),t[p][B].value==null&&l(3,t[p][B].value=u(B,p),t);l(3,t[U][a].status="clear",t),k({detail:{x:a,y:U}}),c.start()}function i(){c.stop(),r="failure";for(let d=0;d<n.height;++d)for(let a=0;a<n.width;++a)l(3,t[d][a].freeze=!0,t),t[d][a].value!=-1&&t[d][a].status=="mark"&&l(3,t[d][a].status="wrong",t)}function g(){return r!="working"||f>0||O()||(c.stop(),r="success"),r}function O(){for(const d of t)for(const a of d)if(a.status=="init")return!0;return!1}function E(){return{status:g(),count:n.count,remain:f,width:n.width,height:n.height,data:t.map(d=>d.map(ie))}}function L(d,a){t[a][d].status=="init"&&(l(4,--f),l(3,t[a][d].status="mark",t))}function m(d,a){t[a][d].status=="init"&&(t[a][d].value>=0?l(3,t[a][d].status="clear",t):(l(3,t[a][d].status="fail",t),i())),document.querySelector(`button#c-${d}-${a}`).click()}function et(){navigator.clipboard.writeText(JSON.stringify(t))}function _(d){vt[d?"unshift":"push"](()=>{n=d,l(1,n)})}function v(d){vt[d?"unshift":"push"](()=>{c=d,l(2,c)})}function A(d,a){s.$$.not_equal(a.status,d)&&(a.status=d,l(3,t))}return[T,n,c,t,f,y,h,k,D,i,E,L,m,et,_,v,A]}class ue extends at{constructor(e){super(),ht(this,e,oe,se,ct,{restart:0,view:10,mark:11,dig:12,do_copy:13})}get restart(){return this.$$.ctx[0]}get view(){return this.$$.ctx[10]}get mark(){return this.$$.ctx[11]}get dig(){return this.$$.ctx[12]}get do_copy(){return this.$$.ctx[13]}}function re(s){let e,l,n,c,o="<code>Go</code>",u,t,r="<code>Step</code>",f,y,h,N,k,T="<code>Go Guess</code>",D,i,g="<code>Step Guess</code>",O,E;return{c(){e=x("div"),l=x("p"),n=j(),c=x("button"),c.innerHTML=o,u=j(),t=x("button"),t.innerHTML=r,f=j(),y=x("br"),h=x("br"),N=j(),k=x("button"),k.innerHTML=T,D=j(),i=x("button"),i.innerHTML=g},l(L){e=C(L,"DIV",{});var m=S(e);l=C(m,"P",{}),S(l).forEach(b),n=H(m),c=C(m,"BUTTON",{"data-svelte-h":!0}),Q(c)!=="svelte-191pd97"&&(c.innerHTML=o),u=H(m),t=C(m,"BUTTON",{"data-svelte-h":!0}),Q(t)!=="svelte-1bunicv"&&(t.innerHTML=r),f=H(m),y=C(m,"BR",{}),h=C(m,"BR",{}),N=H(m),k=C(m,"BUTTON",{"data-svelte-h":!0}),Q(k)!=="svelte-qgdn0r"&&(k.innerHTML=T),D=H(m),i=C(m,"BUTTON",{"data-svelte-h":!0}),Q(i)!=="svelte-1c4pp3z"&&(i.innerHTML=g),m.forEach(b)},m(L,m){M(L,e,m),w(e,l),w(e,n),w(e,c),w(e,u),w(e,t),w(e,f),w(e,y),w(e,h),w(e,N),w(e,k),w(e,D),w(e,i),O||(E=[q(c,"click",s[3]),q(t,"click",s[4]),q(k,"click",s[5]),q(i,"click",s[6])],O=!0)},p:lt,i:lt,o:lt,d(L){L&&b(e),O=!1,ft(E)}}}function ce(s){const e=[];for(let l=0;l<s.height;++l)for(let n=0;n<s.width;++n)s.data[l][n]===" "&&e.push({x:n,y:l});return{cells:e,min:s.remain,max:s.remain}}function Dt(s,e){return s.find(l=>l.x===e.x&&l.y===e.y)!=null}function Ht(s,e){const l=Math.min(s.cells.length,e.cells.length);for(let n=0;n<l;++n){const c=s.cells[n],o=e.cells[n];let u=c.y-o.y;if(u!=0||(u=c.x-o.x,u!=0))return u}return s.cells.length-e.cells.length}function fe(s,e){return s.min==e.min&&s.max==e.max&&s.cells.length==e.cells.length&&Ht(s,e)==0}function ae(s){const e=[];for(const c of s){const o=(c.min+c.max)/c.cells.length;for(const u of c.cells){let t;u.y in e?t=e[u.y]:(t=[],e[u.y]=t),u.x in t?o>t[u.x]&&(t[u.x]=o):t[u.x]=o}}let l=4,n;for(const[c,o]of e.entries())if(o!=null)for(const[u,t]of o.entries())t!=null&&t<l&&(l=t,n={x:u,y:c});return n}function he(s,e,l){let{field:n}=e;const c=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]];function*o(i,g,O){for(let E of c){const L=g+E[0],m=O+E[1];0<=L&&L<i.width&&0<=m&&m<i.height&&(yield{x:L,y:m})}}function u(i,g,O,E){let L=0;for(const m of o(i,g,O))E(i.data[m.y][m.x])&&++L;return L}function t(i,g,O,E){const L=[];for(const m of o(i,g,O))E(i.data[m.y][m.x])&&L.push(m);return L}function r(i){const g=n.view();if(g.status!="working")return!1;const O=f(g,i);if(!O||O.length==0)return!1;for(const E of O)switch(E.op){case"dig":n.dig(E.x,E.y);break;case"mark":n.mark(E.x,E.y)}return!0}function f(i,g){return y(i,g)}function y(i,g){const O=[ce(i)];if(O[0].cells.length==i.height*i.width)return[{op:"dig",x:Math.floor(i.width/2),y:Math.floor(i.height/2)}];for(let _=0;_<i.height;++_)for(let v=0;v<i.width;++v)if(typeof i.data[_][v]=="number"){const A=i.data[_][v],d=t(i,v,_,p=>p===" ");if(d.length==0)continue;const a=u(i,v,_,p=>p==="F"),U=A-a,P={cells:d,min:U,max:U};O.push(P)}const E={};for(const _ of O)for(const v of _.cells){const A=`${v.x},${v.y}`;A in E?E[A].push(_):E[A]=[_]}for(const _ of[...O]){const v=[];for(const A of _.cells){const d=`${A.x},${A.y}`;for(const a of E[d])a!==_&&v.every(U=>U!==a)&&Ht(_,a)>0&&v.push(a)}for(const A of v){const d={cells:[]},a={cells:[]};for(const p of _.cells)Dt(A.cells,p)?a.cells.push(p):d.cells.push(p);const U={cells:[]};for(const p of A.cells)Dt(a.cells,p)||U.cells.push(p);if(U.cells.length==0&&d.cells.length==0)continue;for(const p of[d,U,a])p.min=0,p.max=p.cells.length;let P=!0;for(;P;){P=!1;for(const[p,B]of[[_,d],[A,U]])p.max-B.min<a.max&&(a.max=p.max-B.min,P=!0),p.min-B.max>a.min&&(a.min=p.min-B.max,P=!0),p.max-a.min<B.max&&(B.max=p.max-a.min,P=!0),p.min-a.max>B.min&&(B.min=p.min-a.max,P=!0)}for(const p of[a,d,U].filter(B=>B.cells.length>0&&B.min==B.max))if(!(O.filter(B=>fe(B,p)).length>0)&&(O.push(p),p.cells.length<=8))for(const B of p.cells){const X=`${B.x},${B.y}`;X in E?E[X].push(p):E[X]=[p]}}}let L=O.filter(_=>_.cells.length==_.min),m=[];for(const _ of L)for(const v of _.cells)m.push({op:"mark",x:v.x,y:v.y});L=O.filter(_=>_.max==0);for(const _ of L)for(const v of _.cells)m.push({op:"dig",x:v.x,y:v.y});if(m.length>0)return m;if(!g)return[];const et=ae(O);return et.op="dig",[et]}async function h(i){setTimeout(()=>{r(i)&&h(i)},20)}const N=()=>h(!1),k=()=>r(!1),T=()=>h(!0),D=()=>r(!0);return s.$$set=i=>{"field"in i&&l(2,n=i.field)},[r,h,n,N,k,T,D]}class _e extends at{constructor(e){super(),ht(this,e,he,re,ct,{field:2})}}function de(s){let e,l,n,c,o,u,t,r="github source code",f,y={};return e=new ue({props:y}),s[1](e),n=new _e({props:{field:s[0]}}),{c(){dt(e.$$.fragment),l=j(),dt(n.$$.fragment),c=j(),o=x("br"),u=j(),t=x("a"),t.textContent=r,this.h()},l(h){mt(e.$$.fragment,h),l=H(h),mt(n.$$.fragment,h),c=H(h),o=C(h,"BR",{}),u=H(h),t=C(h,"A",{href:!0,"data-svelte-h":!0}),Q(t)!=="svelte-1iae31h"&&(t.textContent=r),this.h()},h(){I(t,"href","https://github.com/fishautumn/mine")},m(h,N){gt(e,h,N),M(h,l,N),gt(n,h,N),M(h,c,N),M(h,o,N),M(h,u,N),M(h,t,N),f=!0},p(h,[N]){const k={};e.$set(k);const T={};N&1&&(T.field=h[0]),n.$set(T)},i(h){f||(tt(e.$$.fragment,h),tt(n.$$.fragment,h),f=!0)},o(h){nt(e.$$.fragment,h),nt(n.$$.fragment,h),f=!1},d(h){h&&(b(l),b(c),b(o),b(u),b(t)),s[1](null),pt(e,h),pt(n,h)}}}function me(s,e,l){let n;function c(o){vt[o?"unshift":"push"](()=>{n=o,l(0,n)})}return[n,c]}class be extends at{constructor(e){super(),ht(this,e,me,de,ct,{})}}export{be as component};
